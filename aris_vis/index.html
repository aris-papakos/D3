<!DOCTYPE html>
<html>
  <head>
    <link rel='stylesheet' href="main.css">
    <meta charset="utf-8">
    <script type="text/javascript" src="d3/d3.min.js"></script>
    <title>Stream Graph</title>
  </head>
  <body>
    <script type="text/javascript">
    ;

    d3.csv('toydata.csv', function(data) {
             // data.forEach(function(d) {
             //   d.date = format.parse(d.date);
             //   d.value = +d.value;
           console.log(data);
           var w = 800;
           var h = 450;
           var margin = {
                top: 58,
                bottom: 100,
                left: 80,
                right:40
           };
           var width = w - margin.right- margin.left;
           var height = h- margin.top - margin.bottom;
           var dataParser = d3.timeParse("%Y-%m");
           console.log("2014-06");
           console.log(dataParser("2014-06"));

            var x = d3.scaleTime()
                     .domain(d3.extent(data, function (d) {
                             var date = dataParser(d.Month);
                             return date;
                     }))
                     .range([0,width]);

            var y = d3.scaleLinear()
                      .domain([0,d3.max(data, function (d) {
                            return d.count;
                 })])
                 .range([height,0]);



            var xAxis = d3.axisBottom()
                      .scale(x);
                      // .ticks(d3.time.month,1)
                      // .tickFormat(d3.timeFormat("%m/%Y"));
                      // .tickFormat(d3.timeFormat("%m %d"))
                      // .ticks(d3.time.years, 1)//should display 1 year intervals
                      // .tickFormat(d3.time.format('%Y'))//%Y-for year boundaries, such as 2011
                      // .tickSubdivide(12);//subdivide 12 months in a year
            var yAxis = d3.axisLeft()
                          .scale(y)
                          .ticks(5);
            var yAxis_right = d3.axisRight()
                                .scale(y)
                                .ticks(5);
             var svg = d3.select('body').append("svg")
                                       .attr('id', 'chart')
                                       .attr('height',h)
                                       .attr('width', w);
             var stream = svg.append("g")
                        .classed("display",true)
                        .attr('transform', 'translate('+margin.left+','+margin.top+')');


            function plot(params) {
                    // create x axis
                    this.append("g")
                        .classed("x axis", true)
                        .attr('transform', 'translate(0,'+height+')')
                        .call(params.axis.x);
                    // create y axis left
                    this.append("g")
                        .classed("y axis", true)
                        .attr('transform', 'translate(0,0)')
                        .call(params.axis.y);

                    // create y axis right
                    this.append("g")
                        .classed("y axis2", true)
                        .attr('transform', 'translate('+width+',0)')
                        .call(params.axis.y2);
                      }
            plot.call(stream,{
                    data:data,
                    axis:{
                      x: xAxis,
                      y: yAxis,
                      y2: yAxis_right
                    }
               });

             });




    </script>

  </body>
</html>
